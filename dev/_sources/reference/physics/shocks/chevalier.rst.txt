.. _chevalier_theory:
========================================
The Chevalier Self-Similar Solution
========================================

The Chevalier self-similar solution
(:class:`~dynamics.supernovae.shock_dynamics.ChevalierSelfSimilarShockEngine`)
provides a physically motivated and widely adopted description of shocks
generated by supernovae and other explosive transients interacting with a
surrounding circumstellar medium (CSM).

Originally derived by :footcite:t:`chevalierSelfsimilarSolutionsInteraction1982`
to model radio and X-ray emission from supernovae, the Chevalier solution has
since become a foundational framework for modeling shock-powered emission
across a broad range of astrophysical transients.

This page serves as a **theory reference** for the Chevalier self-similar
solution as implemented in Triceratops. All assumptions, scalings, and
normalizations used by the corresponding shock engines are derived and
documented explicitly below.

Overview and Assumptions
------------------------

The Chevalier solution describes the interaction between homologously expanding
supernova ejecta and an ambient medium under the assumption of self-similar
evolution. Specifically, it assumes:

- The ejecta density follows a power-law distribution in velocity space:

  .. math::

        \rho(r, t) = A_1\, t^{-3} \left(\frac{r}{t}\right)^{-n},

- The circumstellar medium (CSM) density follows a power-law distribution in
  radius:

  .. math::

        \rho_{\rm csm}(r) = A_4\, r^{-s},

- The shock dynamics are self-similar, such that the shock radius and velocity
  evolve as power laws in time.

- The shocks are strong and adiabatic, allowing the use of the
  Rankine–Hugoniot jump conditions to relate upstream and downstream
  thermodynamic quantities.

- The forward and reverse shocks are sufficiently close that the shocked region
  may be treated as a thin shell when computing radiative properties.

  While the original work of
  :footcite:t:`chevalierSelfsimilarSolutionsInteraction1982` solved the full
  self-similar ordinary differential equation system to obtain the detailed
  internal structure of the shocked region, it has become standard practice to
  adopt the thin-shell approximation for radiative modeling, following
  :footcite:t:`ChevalierXRayRadioEmission1982`.

Self-Similar Scaling Relations
------------------------------

In a self-similar framework, there can be no intrinsic length or timescale.
Consequently, ratios of physical quantities must remain constant over time.
Requiring that the ratio of the ejecta density to the CSM density remain fixed
at the shock radius leads to a power-law evolution for the shock radius:

.. math::

    R_{\rm sh}(t) =
    \left[\frac{A_4}{A_1} \zeta\right]^{1/(s-n)} t^{(3-n)/(s-n)}
    \equiv A_{\rm sh}\, t^{\lambda},

where :math:`\zeta` is a dimensionless constant determined by the solution of
the self-similar ODEs, and

.. math::

    \lambda = \frac{n-3}{n-s}.

The corresponding shock velocity is

.. math::

    v_{\rm sh}(t) = \frac{dR_{\rm sh}}{dt}
    = \lambda A_{\rm sh} t^{\lambda - 1}
    = \lambda \frac{R_{\rm sh}}{t}.

The normalization constant :math:`A_{\rm sh}` encodes the detailed structure of
the shocked region and, in general, cannot be obtained in closed form. This
motivates the use of the thin-shell approximation, which allows approximate
expressions for :math:`A_{\rm sh}` to be derived analytically.

Thin-Shell Normalization
------------------------


In the thin-shell approximation, the net pressure force acting on the shell
balances the rate of change of momentum of the swept-up material:

.. math::

    \frac{d}{dt}\!\left[(M_2 + M_3)\,\dot{R}_{\rm sh}\right]
    = 4\pi R_{\rm sh}^2 (P_3 - P_2).

The mass swept up by the forward shock is

.. math::

    M_3(R_{\rm sh}) = \frac{4\pi A_4}{3-s} R_{\rm sh}^{3-s}.

The mass swept up by the reverse shock corresponds to ejecta material with
velocities exceeding

.. math::

    \tilde{v} = \frac{R_{\rm sh}}{t},

yielding

.. math::

    M_2(t)
    = \int_{R_{\rm sh}}^{\infty} 4\pi \xi^2 \rho_1(\xi,t)\,d\xi
    \simeq \frac{4\pi A_1}{n-3} t^{n-3} R_{\rm sh}^{3-n},

valid for :math:`n > 3`.

The total shell mass is therefore

.. math::

    M_{\rm sh}
    = 4\pi \left[
        \frac{A_4}{3-s} R_{\rm sh}^{3-s}
        + \frac{A_1}{n-3} t^{n-3} R_{\rm sh}^{3-n}
    \right].

Substituting the self-similar ansatz yields

.. math::

    M_{\rm sh} = K_{\rm sh} t^{\gamma},
    \qquad
    \gamma = \frac{(n-3)(3-s)}{n-s}.

Using the strong-shock Rankine–Hugoniot relations, the post-shock pressures
are

.. math::

    P_2 = \frac{3}{4}\rho_1(R_{\rm sh},t)
    (\tilde{v} - \dot{R}_{\rm sh})^2,

.. math::

    P_3 = \frac{3}{4}\rho_4(R_{\rm sh}) \dot{R}_{\rm sh}^2.

.. note::

    Some references omit the factor of :math:`3/4`, as it introduces only an
    order-unity correction. Triceratops retains the full factor for accuracy.

Collecting terms yields the dimensionless normalization constant

.. math::

    \boxed{
    \zeta =
    \frac{
        3\lambda^2
        + 4 \frac{(\lambda - 1)\lambda}{3-s}
    }{
        3(1-\lambda)^2
        - 4 \frac{(\lambda - 1)\lambda}{n-3}
    }.
    }

For a wind-like CSM (:math:`s = 2`), this reduces to

.. math::

    \zeta = \frac{(n-4)(n-3)}{2},

consistent with :footcite:t:`ChevalierXRayRadioEmission1982`. With :math:`\zeta` specified, the
full shock dynamics are completely determined.

Ejecta Density Normalization
----------------------------

To connect the ejecta density profile to physical parameters, it is convenient
to express the normalization in terms of the total ejecta mass
:math:`M_{\rm ej}` and kinetic energy :math:`E_{\rm ej}`.

We adopt a broken power-law ejecta profile motivated by hydrodynamical
simulations, with an inner slope :math:`\delta` and an outer slope :math:`n`:

.. math::

    \rho(r,t) = K t^{-3}
    \begin{cases}
        v^{-\delta}, & v < v_t, \\
        v_t^{n-\delta} v^{-n}, & v \geq v_t.
    \end{cases}

Mass conservation requires

.. math::

    M_{\rm ej}
    = 4\pi K v_t^{3-\delta}
      \frac{n-\delta}{(3-\delta)(n-3)},

and energy conservation gives

.. math::

    E_{\rm ej}
    = 2\pi K v_t^{5-\delta}
      \frac{n-\delta}{(5-\delta)(n-5)}.

Combining these expressions yields the transition velocity

.. math::

    v_t^2 =
    \frac{2(5-\delta)(n-5)}{(3-\delta)(n-3)}
    \frac{E_{\rm ej}}{M_{\rm ej}},

and the density normalization

.. math::

    K =
    \frac{1}{4\pi}
    \left(\frac{(3-\delta)(n-3)}{n-\delta}\right)
    \frac{M_{\rm ej}}{v_t^{3-\delta}}.

CSM Density Normalization
--------------------------

The CSM density normalization :math:`A_4` is less easily connected to global physical parameters than the ejecta
density. In the most general case, one can either choose to specify :math:`A_4` directly relate it to some fiducial
density such that

.. math::

    \rho_{\rm CSM}(r) = \rho_0 \left(\frac{r}{r_0}\right)^{-s} = A_4 r^{-s}.

In some special cases, the normalization of the CSM is dictated by the additional features of the system.

Wind-Like CSM
~~~~~~~~~~~~~~~~~~

The most common example of a physically motivated CSM normalization is that of a steady wind, for which
:math:`s = 2`. In this case, mass conservation requires

.. math::

    A_4 = \frac{\dot{M}}{4\pi v_w},

where :math:`\dot{M}` is the mass-loss rate of the progenitor star, and :math:`v_w` is the wind velocity.
This normalization is widely used to model the CSM around massive stars that have undergone steady
mass loss prior to explosion.

References
----------
.. footbibliography::
