
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/a_data/plot_specific_epochs.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_a_data_plot_specific_epochs.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_a_data_plot_specific_epochs.py:


====================================
Plot Single Epochs
====================================

In this simple cookbook, we'll load in some data and
break it into epochs and then plot a subset of those
epochs using the :meth:`~data.photometry.RadioPhotometryContainer.plot_epoch`
method of :class:`data.photometry.RadioPhotometryContainer`.

.. GENERATED FROM PYTHON SOURCE LINES 13-16

Setup
-----
First, we need to import the necessary libraries and set up the plotting style.

.. GENERATED FROM PYTHON SOURCE LINES 16-22

.. code-block:: Python

    import matplotlib.pyplot as plt
    from astropy import units as u

    from triceratops.data.photometry import RadioPhotometryContainer
    from triceratops.utils.plot_utils import set_plot_style








.. GENERATED FROM PYTHON SOURCE LINES 23-30

We'll use a set of synthetically generated radio photometry data for this example. The data is
stored in the ``_data/example_photometry.fits`` file within the documentation source directory.

This dataset is almost in the perfect format for loading into a
:class:`data.photometry.RadioPhotometryContainer`, except that it doesn't have an explicit ``time`` column, so
we will need to select one. We also need to give a reference time for the observations, which we will set to the JD
of the first observation.

.. GENERATED FROM PYTHON SOURCE LINES 30-48

.. code-block:: Python


    # Resolve the path to the dataset. In this case, we seek out the data in the
    # documentation.
    data_file = "../../../../../docs/source/_data/example_photometry.fits"

    # Load the dataset as a RadioPhotometryContainer. We specify that the ``time`` column
    # should be taken from the ``time_midobs`` column in the dataset.
    photometry_data = RadioPhotometryContainer.from_file(
        data_file,
        column_map={"time_midobs": "time"},
        time_starts=2458368.45645 * u.day,  # Reference time (JD of first observation)
    )
    print(f"Loaded photometry data with {len(photometry_data)} entries.")

    # Render the table into the documentation.
    photometry_data.table.pprint()






.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Loaded photometry data with 62 entries.
        obs_name         flux_density      ... beam_minor_axis beam_angle
           na                 Jy           ...      arcsec        deg    
    --------------- ---------------------- ... --------------- ----------
    obs1_L_band1of2  0.0008397371110273543 ...           24.74      -20.9
    obs1_L_band2of2   0.001380642947400138 ...           18.27      -17.5
    obs1_S_band1of2  0.0023957298217117994 ...           12.36      -17.5
    obs1_S_band2of2  0.0037334616541369017 ...            9.71      -14.4
    obs1_C_band1of2   0.004921986879267783 ...            7.03      -18.7
    obs1_C_band2of2   0.007578309663898102 ...            5.09      -15.9
    obs1_X_band1of2   0.010537084131965368 ...            3.98      -19.2
    obs1_X_band2of2    0.01055208615971873 ...            3.46      -21.1
    obs1_K_band1of4    0.00821531350281548 ...            2.65      -66.2
                ...                    ... ...             ...        ...
             obs8_L                     -- ...            1.26         54
             obs8_S                     -- ...            0.64       19.4
             obs8_X                     -- ...             0.2       31.8
           obsg1_b5  0.0004268404374563874 ...            2.24       78.1
           obsg1_b3                     -- ...            6.96         80
           obsg2_g5                     -- ...            2.34       60.2
           obsg2_b4 0.00023375250854007943 ...             4.4       81.6
           obsg2_b3                     -- ...            7.74       70.8
           obsg3_b4                     -- ...            3.94       46.2
           obsg3_b3                     -- ...            7.54       86.7
    Length = 62 rows




.. GENERATED FROM PYTHON SOURCE LINES 49-56

If you already have clearly defined epochs in mind, you can specify them directly in your table using the
``epoch_id`` column, or you can use the built-in method
:meth:`~data.photometry.RadioPhotometryContainer.set_epochs_from_indices`; however, we do not have that information here.

Instead, we can use the :meth:`~data.photometry.RadioPhotometryContainer.set_epochs_from_time_gaps` method to
automatically define epochs based on gaps in the observation times. We'll specify a gap threshold of 2 days to
separate the epochs.

.. GENERATED FROM PYTHON SOURCE LINES 56-60

.. code-block:: Python


    # Set epochs based on time gaps of 2 days.
    photometry_data.set_epochs_from_time_gaps(max_gap=3.0 * u.day)








.. GENERATED FROM PYTHON SOURCE LINES 61-62

Now that we have defined each of the epochs, we can plot the SEDs for each epoch using the epoch masks.

.. GENERATED FROM PYTHON SOURCE LINES 62-88

.. code-block:: Python

    set_plot_style()
    fig, axes = plt.subplots(figsize=(10, 6))

    # Plot specific epochs by their IDs.
    epoch_ids_to_plot = [0, 2, 5]  # Plot epochs with IDs 0
    colors = ["darkblue", "darkgreen", "darkred"]

    for k, epoch_id in enumerate(epoch_ids_to_plot):
        photometry_data.plot_epoch(
            epoch_id=epoch_id,
            fig=fig,
            axes=axes,
            show_upper_limits=True,
            color=colors[k],
            detection_style={"marker": "o", "markersize": 5, "mfc": "w", "mec": colors[k], "ls": "--", "linewidth": 1.5},
            label=f"Epoch {epoch_id}",
        )

    axes.set_xlabel("Frequency (GHz)")
    axes.set_ylabel("Flux Density (mJy)")
    axes.legend()
    axes.set_title("Radio Photometry for Specific Epochs")
    axes.set_xscale("log")
    axes.set_yscale("log")

    plt.show()



.. image-sg:: /auto_examples/a_data/images/sphx_glr_plot_specific_epochs_001.png
   :alt: Radio Photometry for Specific Epochs
   :srcset: /auto_examples/a_data/images/sphx_glr_plot_specific_epochs_001.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.199 seconds)


.. _sphx_glr_download_auto_examples_a_data_plot_specific_epochs.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_specific_epochs.ipynb <plot_specific_epochs.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_specific_epochs.py <plot_specific_epochs.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_specific_epochs.zip <plot_specific_epochs.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
